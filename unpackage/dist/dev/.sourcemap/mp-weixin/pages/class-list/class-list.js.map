{"version":3,"file":"class-list.js","sources":["pages/class-list/class-list.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2xhc3MtbGlzdC9jbGFzcy1saXN0LnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"classlist\">\r\n\t\t<!-- 判断是否本类图片是否没有数据 -->\r\n\t\t<view class=\"loadingLayout\" v-if=\"!classList.length && !noData\">\r\n\t\t\t<uni-load-more status=\"loading\"></uni-load-more>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"content\">\r\n\t\t\t<navigator :url=\"`/pages/preview/preview?id=${i._id}`\" :key=\"i._id\" class=\"item\" v-for=\"i in classList\">\r\n\t\t\t\t<image :src=\"i.smallPicurl\" mode=\"aspectFill\"></image>\r\n\t\t\t</navigator>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 触底加载动画 -->\r\n\t\t<view class=\"loadingLayout\" v-if=\"classList.length || noData\">\r\n\t\t\t<uni-load-more :status=\"noData?'noMore':'loading'\"></uni-load-more>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"safe-area-inset-bottom\">\r\n\t\t\t\r\n\t\t</view>\r\n\t\t\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue';\r\nimport {apiGetClassList,apiGetHistoryList} from '@/api/apis.js'\r\nimport { onLoad,onUnload,onReachBottom} from '@dcloudio/uni-app'\r\n\r\nconst classList = ref([])\r\nconst noData = ref(false)\r\nconst queryParams = {classid:'',pageNum:1,pageSize:12}\r\n\r\n// 接受参数,并请求数据\r\nonLoad((options) => {\r\n  // options 中包含所有传递过来的参数\r\n  let {classid=null,name=null,type=null} = options\r\n  if(type)queryParams.type = type\r\n  if(classid)queryParams.classid=classid\r\n  console.log('接收的参数id:', options)\r\n  uni.setNavigationBarTitle({\r\n  \ttitle:name\r\n  })\r\n  //onload晚于setup\r\n  getClassList()\r\n})\r\n\r\n// 请求分类列表\r\nconst getClassList = async()=>{\r\n\tlet res;\r\n\tif(queryParams.classid) res = await apiGetClassList(queryParams)\r\n\tif(queryParams.type) res = await apiGetHistoryList(queryParams)\r\n\r\n\tclassList.value.push(...res.data)  //...将一个可迭代对象\"展开\" ,再通过push加入classList列表\r\n\t\r\n\t//判断获取到的数据是否是最后一页，来判断是否禁止触底请求\r\n\tif(queryParams.pageSize  > res.data.length) noData.value = true\r\n\tuni.setStorageSync(\"storageClassList\",classList.value)\r\n\tconsole.log(res)\r\n}\r\n\r\n\r\n// 触底加载更多\r\nonReachBottom(()=>{\r\n\tif(noData.value) return\r\n\tqueryParams.pageNum++,\r\n\tgetClassList()\r\n})\r\n\r\nonUnload(()=>{\r\n\tuni.removeStorageSync('storageClassList')\r\n})\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.classlist{\r\n\t.content{\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: repeat(3,1fr);\r\n\t\tgap: 5rpx;\r\n\t\tpadding: 5rpx;\r\n\t\t.item{\r\n\t\t\theight: 440rpx;\r\n\t\t\timage{\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}     \r\n</style>\r\n","import MiniProgramPage from 'D:/HBuilderX/HBuilderProjects/InstantWallpaper/pages/class-list/class-list.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","uni","apiGetClassList","apiGetHistoryList","onReachBottom","onUnload"],"mappings":";;;;;;;;;;;;;;AA8BA,UAAM,YAAYA,cAAG,IAAC,EAAE;AACxB,UAAM,SAASA,cAAG,IAAC,KAAK;AACxB,UAAM,cAAc,EAAC,SAAQ,IAAG,SAAQ,GAAE,UAAS,GAAE;AAGrDC,kBAAM,OAAC,CAAC,YAAY;AAElB,UAAI,EAAC,UAAQ,MAAK,OAAK,MAAK,OAAK,KAAI,IAAI;AACzC,UAAG;AAAK,oBAAY,OAAO;AAC3B,UAAG;AAAQ,oBAAY,UAAQ;AAC/BC,oBAAAA,4DAAY,YAAY,OAAO;AAC/BA,oBAAAA,MAAI,sBAAsB;AAAA,QACzB,OAAM;AAAA,MACT,CAAG;AAED,mBAAc;AAAA,IAChB,CAAC;AAGD,UAAM,eAAe,YAAS;AAC7B,UAAI;AACJ,UAAG,YAAY;AAAS,cAAM,MAAMC,SAAAA,gBAAgB,WAAW;AAC/D,UAAG,YAAY;AAAM,cAAM,MAAMC,SAAAA,kBAAkB,WAAW;AAE9D,gBAAU,MAAM,KAAK,GAAG,IAAI,IAAI;AAGhC,UAAG,YAAY,WAAY,IAAI,KAAK;AAAQ,eAAO,QAAQ;AAC3DF,oBAAAA,MAAI,eAAe,oBAAmB,UAAU,KAAK;AACrDA,oBAAAA,MAAY,MAAA,OAAA,yCAAA,GAAG;AAAA,IAChB;AAIAG,kBAAAA,cAAc,MAAI;AACjB,UAAG,OAAO;AAAO;AACjB,kBAAY,WACZ,aAAc;AAAA,IACf,CAAC;AAEDC,kBAAAA,SAAS,MAAI;AACZJ,oBAAG,MAAC,kBAAkB,kBAAkB;AAAA,IACzC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;ACvED,GAAG,WAAW,eAAe;"}